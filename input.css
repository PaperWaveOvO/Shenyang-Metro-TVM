@import "tailwindcss";

/* 基础思源黑体 - 常规 */
@font-face {
    font-family: 'Source Han Sans SC';
    src: url('../resources/fonts/SOURCEHANSANSSC-REGULAR.woff2') format('woff2');
    font-weight: 400;
}

/* 基础思源黑体 - 加粗 */
@font-face {
    font-family: 'Source Han Sans SC';
    src: url('../resources/fonts/SOURCEHANSANSSC-BOLD.woff2') format('woff2');
    font-weight: 700;
}

/* 其他地区字体 */
@font-face {
    font-family: 'Source Han Sans JP';
    src: url('../resources/fonts/SourceHanSans-Regular.woff2') format('woff2');
    font-weight: 400;
}

@font-face {
    font-family: 'Source Han Sans JP';
    src: url('../resources/fonts/SourceHanSans-Bold.woff2') format('woff2');
    font-weight: 700;
}

@font-face {
    font-family: 'Source Han Sans TC';
    src: url('../resources/fonts/SourceHanSansTC-Regular.woff2') format('woff2');
    font-weight: 400;
}

@font-face {
    font-family: 'Source Han Sans TC';
    src: url('../resources/fonts/SourceHanSansTC-Bold.woff2') format('woff2');
    font-weight: 700;
}

@font-face {
    font-family: 'Source Han Sans KR';
    src: url('../resources/fonts/SourceHanSansKR-Regular.woff2') format('woff2');
    font-weight: 400;
}

@font-face {
    font-family: 'Source Han Sans KR';
    src: url('../resources/fonts/SourceHanSansKR-Bold.woff2') format('woff2');
    font-weight: 700;
}

@font-face {
    font-family: 'Inter';
    src: url('../resources/fonts/INTER-REGULAR.woff2') format('woff2');
    font-weight: 400;
}

@font-face {
    font-family: 'Inter';
    src: url('../resources/fonts/INTER-BOLD.woff2') format('woff2');
    font-weight: 700;
}

/* 默认字体 */
body {
    font-family: 'Inter', 'Source Han Sans SC', sans-serif;
    overflow: hidden;
}

/* 当 <html lang="ja-JP"> 时应用 */
html:lang(ja-JP) * {
    font-family: 'Inter', 'Source Han Sans JP', 'Source Han Sans SC', sans-serif;
}

/* 当 <html lang="zh-TW"> 或 <html lang="zh-HK"> 时应用 */
html:lang(zh-TW) *,
html:lang(zh-HK) * {
    font-family: 'Inter', 'Source Han Sans TC', 'Source Han Sans SC', sans-serif;
}

/* 当 <html lang="ko-KR"> 时应用 */
html:lang(ko-KR) * {
    font-family: 'Inter', 'Source Han Sans KR', 'Source Han Sans SC', sans-serif;
}

/* 激活 Overlay 时的显示 */
#langOverlay.active {
    display: flex;
}

/* 激活语言项时的视觉反馈 */
.lang-item.active span {
    color: white;
}

/* 容器变灰效果 (当弹窗出现时，主界面变模糊/深色) */
.tvm-container.lang-mode {
    filter: blur(4px) brightness(0.8);
    pointer-events: none; /* 防止弹窗时还能点到背景 */
}

.tvm-button, 
.station-name-bg, 
.lang-item, 
.btn-quick, 
.btn-counter {
    position: relative;
    /* 必须是 visible，否则那外扩的 1px 又被切掉了 */
    overflow: visible !important; 
    /* 某些情况下 z-index 可以帮助提升渲染层级 */
    z-index: 1; 
}

/* 弹窗主体 */
#langOverlay {
    position: fixed; /* 使用 fixed 确保覆盖全屏 */
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;             /* 始终为 flex */
    align-items: center;       /* 垂直居中 */
    justify-content: center;   /* 水平居中 */
    z-index: 9999; 
    
    opacity: 0;                /* 初始透明 */
    pointer-events: none;      /* 初始不可点击 */
    transition: opacity 0.3s ease;
}

/* 激活遮罩 */
#langOverlay.active {
    opacity: 1;
    pointer-events: auto;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
}

/* 模态框主体：默认向下偏移 */
#langModal {
    position: relative;
    transform: translateY(10%); /* 初始位置更靠下一点 */
    opacity: 0;
    transition: 
        transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), 
        opacity 0.4s ease;
    overflow: visible !important;
}

svg {
    /* 确保所有 SVG 默认不裁剪 */
    overflow: visible !important;
}

#langModal svg {
    /* 核心：即使 path 超出了 viewBox 0.5 像素，也要显示出来 */
    overflow: visible !important; 
    /* 确保它铺满模态框且不挡住点击 */
    position: absolute;
    inset: 0;
    pointer-events: none;
    /* 确保 SVG 不会被父级背景遮挡 */
    z-index: 0; 
    /* 某些安卓机型需要这个来强制重绘 */
    will-change: auto; 
}

/* 遮罩激活时，模态框向上弹出 */
#langOverlay.active #langModal {
    transform: translateY(0);
    opacity: 1;
}

/* 模糊背景 */
.tvm-container.lang-mode {
    pointer-events: none;
}

/* 主内容区负责裁剪和尺寸 */
.main-content-area {
    position: relative;
    flex: 1;
    width: 100%;
    overflow: hidden;
    background-color: #f3f4f6;
}

/* 1. 基础状态：绝对定位，默认透明并隐藏 */
.tvm-body {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    display: flex;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    will-change: transform, opacity;
}

/* 2. 动画过渡类 */
.screen-transition {
    visibility: visible !important; 
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.screen-left {
    transform: translateX(-100%) !important;
    opacity: 0 !important;
}

.screen-right {
    transform: translateX(100%) !important;
    opacity: 0 !important;
}

/* 4. 中心状态 */
.screen-center {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    transform: translateX(0) !important;
    z-index: 10;
}

/* 强制清除 display: none */
.tvm-body:not(.hidden) {
    display: flex !important;
}
.hidden { display: none !important; }

/* 解决底部露白：强制主区域背景色一致或溢出隐藏 */
.main-content-area {
    position: relative;
    overflow: hidden;
    background-color: #f3f4f6; /* bg-gray-100 的色值 */
}

#screen-by-distance,
#screen-by-amount {
    position: absolute;
    inset: 0;
}

/* 强制覆盖浏览器默认样式 */
.tvm-button, .btn-quick, .btn-counter {
    -webkit-appearance: none;
    appearance: none;
    border: none; /* 确保没有默认边框占位 */
    outline: none;
    position: relative;
    overflow: visible !important;
    z-index: 1; /* 建立层叠上下文 */
}

/* 确保 SVG 处于背景层但不会被切 */
.tvm-button svg, .station-name-bg svg {
    overflow: visible !important;
    z-index: 0;
    pointer-events: none;
    /* 强制硬件加速，解决模糊 */
    transform: translateZ(0); 
    will-change: transform;
}

/* 按钮内容层级要高 */
.tvm-button span, .tvm-button img {
    position: relative;
    z-index: 10;
}

/* 模态框修正 */
#langModal {
    overflow: visible !important;
}
